import{_ as q}from"./index-2b893b53.js";import{r as s,G as w,c as K,m as x,w as o,e as n,f as i,i as M,aM as T,M as $,aN as O,aO as C,ar as B,d as S,R as E,h as v,ap as P,aP as L,I as R,B as U,W as V}from"./index-eb14e6bd.js";import{f as D,g as k}from"./index-a6ad3bbb.js";import{_ as A,P as G}from"./index-f25cfa19.js";import{D as F}from"./slotCell.vue_vue_type_script_lang-12effd0a.js";import{_ as W}from"./index-b6e47c4f.js";import{L as Y}from"./index-158b6f05.js";import"./index-e40dd58c.js";const j={__name:"edit",emits:["submit"],setup(I,{expose:c,emit:f}){const t=s(!1),d=f,r=s(null),b=w(()=>`${r.value?"编辑":"新建"}物料`);s({});const m=s(null),e=s([]),a=s([{cmp:"input",name:"itemCode",label:"物料编号",rules:[{required:!0,message:"必填",type:"error",trigger:"blur"}]},{cmp:"input",name:"itemName",label:"物料名称",rules:[{required:!0,message:"必填",type:"error",trigger:"blur"}]},{cmp:"treeSelect",name:"itemTypeId",label:"所属分类",itemOptions:{data:e,keys:{value:"id"}},rules:[{required:!0,message:"必选",type:"error",trigger:"change"}]},{cmp:"input",name:"unitOfMeasure",label:"单位"},{cmp:"textarea",name:"specification",label:"规格型号"},{cmp:"radio",name:"enableFlag",label:"状态",itemOptions:{options:D(k)},rules:[{required:!0,message:"必选",type:"error",trigger:"change"}]},{cmp:"textarea",name:"remark",label:"备注"}]),y=async()=>{const l=await m.value.getFormData(!0);if(l===!1)return!1;l.itemId?(await T(l),$.success("物料编辑成功")):(await O(l),$.success("物料添加成功")),d("submit"),t.value=!1},u=()=>{B().then(l=>{e.value=l.data||[]})};return c({open:(l=null)=>{r.value=l,u(),l&&C({id:l}).then(_=>{m.value.fillFormData(_.data)}),t.value=!0}}),(l,_)=>{const p=A,h=F;return K(),x(h,{visible:i(t),"onUpdate:visible":_[0]||(_[0]=N=>M(t)?t.value=N:null),attach:"body",header:i(b),"destroy-on-close":"",placement:"center",width:"600px","on-confirm":y},{body:o(()=>[n(p,{ref_key:"$form",ref:m,forms:i(a),initData:{enableFlag:"Y",safeStockFlag:"N"}},null,8,["forms"])]),_:1},8,["visible","header"])}}},z={__name:"detail",emits:["submit"],setup(I,{expose:c,emit:f}){const t=s(!1),d=w(()=>`查看物料-${r.value.itemName}`),r=s({}),b=[{colKey:"itemCode",label:"物料编号"},{colKey:"itemName",label:"物料名称"},{colKey:"specification",label:"规格型号"},{colKey:"unitOfMeasure",label:"单位"},{colKey:"itemTypeName",label:"所属分类"},{colKey:"createTime",label:"创建时间",width:180},{colKey:"enableFlag",label:"状态",cell:e=>{var a;return(a=k[e.enableFlag])==null?void 0:a.label}},{colKey:"remark",label:"备注"}];return c({open:(e=null)=>{e&&(C({id:e}).then(a=>{r.value=a.data}),t.value=!0)}}),(e,a)=>{const y=W,u=F;return K(),x(u,{visible:i(t),"onUpdate:visible":a[0]||(a[0]=g=>M(t)?t.value=g:null),attach:"body",header:i(d),"destroy-on-close":"",placement:"center",width:"600px",footer:!1},{body:o(()=>[n(y,{columns:b,data:i(r)},null,8,["data"])]),_:1},8,["visible","header"])}}},le={__name:"index",setup(I){const c=s(null),f=s(null),t=s(null),d=[{cmp:"input",name:"itemName",label:"物料名称"},{cmp:"select",name:"enableFlag",label:"状态",itemOptions:{options:D(k)}}],r=[{colKey:"serial-number",title:"#",width:60},{colKey:"itemCode",title:"物料编号",width:140},{colKey:"itemName",title:"物料名称"},{colKey:"specification",title:"规格型号"},{colKey:"unitOfMeasure",title:"单位",width:80},{colKey:"itemTypeName",title:"所属分类"},{colKey:"createTime",title:"创建时间",width:180},{colKey:"enableFlag",title:"状态",cell:(m,{row:e})=>{var a;return(a=k[e.enableFlag])==null?void 0:a.label},width:80},{colKey:"operation",title:"操作",width:160}],b=m=>{L({id:m}).then(e=>{$.success("物料删除成功"),t.value.refresh()})};return(m,e)=>{const a=R,y=U,u=Y,g=G,l=V,_=q;return K(),S(E,null,[n(_,{ref_key:"$table",ref:t,searchItems:d,columns:r,api:i(P)},{topBtns:o(()=>[n(y,{onClick:e[0]||(e[0]=p=>i(c).open())},{icon:o(()=>[n(a,{name:"add"})]),default:o(()=>[v(" 新建物料 ")]),_:1})]),operation:o(({row:p})=>[n(l,null,{default:o(()=>[n(u,{theme:"primary",onClick:h=>i(f).open(p.itemId)},{default:o(()=>[v(" 查看 ")]),_:2},1032,["onClick"]),n(u,{theme:"primary",onClick:h=>i(c).open(p.itemId)},{default:o(()=>[v(" 编辑 ")]),_:2},1032,["onClick"]),n(g,{content:"确认删除吗？",onConfirm:h=>b(p.itemId)},{default:o(()=>[n(u,{theme:"primary"},{default:o(()=>[v("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:1},8,["api"]),n(j,{ref_key:"$DialogEdit",ref:c,onSubmit:e[1]||(e[1]=p=>i(t).refresh())},null,512),n(z,{ref_key:"$DialogDetail",ref:f},null,512)],64)}}};export{le as default};
